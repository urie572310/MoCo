<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Device Geolocation</title>
</head>
<body>
    <h2>å–å¾—ç›®å‰ä½ç½®</h2>
    <button id="getLocationBtn">å–å¾—å®šä½è³‡æ–™</button>

    <script>
        const btn = document.getElementById("getLocationBtn");

        btn.addEventListener("click", () => {
            // 1ï¸âƒ£ æª¢æŸ¥ç€è¦½å™¨æ”¯æ´
            if (!navigator.geolocation) {
                console.log("âŒ ä½ çš„ç€è¦½å™¨ä¸æ”¯æ´ Geolocation API");
                return;
            }

            // 2ï¸âƒ£ è«‹æ±‚æ¬Šé™ï¼ˆéƒ¨åˆ†ç€è¦½å™¨éœ€è¦ HTTPSï¼‰
            navigator.permissions.query({ name: "geolocation" }).then((result) => {
                console.log("ğŸ” ç›®å‰æ¬Šé™ç‹€æ…‹ï¼š", result.state);

                if (result.state === "denied") {
                    console.log("âŒ ä½¿ç”¨è€…å°é–äº†å®šä½æ¬Šé™");
                    return;
                }

                // 3ï¸âƒ£ å–å¾—ä½ç½®
                navigator.geolocation.getCurrentPosition(
                    (position) => {
                        const lat = position.coords.latitude;
                        const lon = position.coords.longitude;
                        const alt = position.coords.altitude;  // æœ‰äº›è¨­å‚™æœƒå›å‚³ null

                        console.log("ğŸ“ ç·¯åº¦ï¼š", lat);
                        console.log("ğŸ“ ç¶“åº¦ï¼š", lon);
                        console.log("â›°ï¸ æµ·æ‹”ï¼ˆå¯èƒ½ç‚º nullï¼‰ï¼š", alt);
                    },
                    (error) => {
                        console.log("âŒ å–å¾—ä½ç½®å¤±æ•—ï¼š", error.message);
                    },
                    {
                        enableHighAccuracy: true, // ç›¡é‡æé«˜ç²¾æº–åº¦
                        timeout: 5000,
                        maximumAge: 0
                    }
                );
            });
        });
    </script>
</body>
</html>
