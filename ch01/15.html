<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å³æ™‚ä½ç½®é¡¯ç¤º</title>
    <style>
        body { font-family: Arial; line-height: 1.6; padding: 20px; }
        .box { padding: 10px; border: 1px solid #ccc; border-radius: 8px; }
    </style>
</head>
<body>

    <h2>ğŸ“ å³æ™‚ä½ç½®</h2>
    <button id="startBtn">é–‹å§‹å–å¾—ä½ç½®</button>

    <div class="box">
        <p>ç·¯åº¦ï¼š<span id="lat">-</span></p>
        <p>ç¶“åº¦ï¼š<span id="lon">-</span></p>
        <p>æµ·æ‹”ï¼š<span id="alt">-</span></p>
    </div>

<script>
    // iOS çš„æ„Ÿæ¸¬å™¨æ¬Šé™ï¼ˆéå¿…é ˆï¼Œä½†é¿å…éŒ¯èª¤ï¼‰
    async function requestIOSPermission() {
        if (typeof DeviceMotionEvent?.requestPermission === "function") {
            await DeviceMotionEvent.requestPermission().catch(()=>{});
        }
        if (typeof DeviceOrientationEvent?.requestPermission === "function") {
            await DeviceOrientationEvent.requestPermission().catch(()=>{});
        }
    }

    // å³æ™‚ GPS ä½ç½® watchPosition()
    function startGPSWatch() {
        if (!navigator.geolocation) {
            console.log("âŒ æ­¤ç€è¦½å™¨ä¸æ”¯æ´å®šä½");
            return;
        }

        navigator.geolocation.watchPosition(
            (pos) => {
                const c = pos.coords;

                document.getElementById("lat").textContent = c.latitude.toFixed(6);
                document.getElementById("lon").textContent = c.longitude.toFixed(6);

                if (c.altitude !== null) {
                    document.getElementById("alt").textContent = c.altitude.toFixed(2) + " m";
                } else {
                    document.getElementById("alt").textContent = "ç„¡æ³•å–å¾—";
                }

                console.log("ğŸ“ ç·¯åº¦:", c.latitude);
                console.log("ğŸ“ ç¶“åº¦:", c.longitude);
                console.log("â›°ï¸ æµ·æ‹”:", c.altitude);
            },
            (err) => {
                console.log("âŒ ä½ç½®å–å¾—å¤±æ•—:", err.message);
            },
            { enableHighAccuracy: true }
        );
    }

    document.getElementById("startBtn").addEventListener("click", async () => {
        await requestIOSPermission();
        startGPSWatch();
        console.log("ğŸ“¡ é–‹å§‹å³æ™‚å–å¾—ä½ç½®");
    });
</script>

</body>
</html>
